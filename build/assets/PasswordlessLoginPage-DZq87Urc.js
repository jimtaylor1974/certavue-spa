import{b as d,c as f,d as h,h as m,r as s,u as p,j as e,A as x,L as g,H as j,b6 as A}from"./index-kwN8UPoG.js";import{u as k}from"./useRouteQuery-BPfCla8K.js";const y=a=>{const r=d();return f({mutationFn:async t=>{const n=await r(`${h}/api/auth/authenticate-with-token`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return m(n)},...a})},S=a=>{const r=s.useRef(void 0),t=s.useRef(!1),n=s.useRef(!1),[i,o]=s.useState(0);t.current&&(n.current=!0),s.useEffect(()=>(t.current||(r.current=a(),t.current=!0),o(c=>c+1),()=>{n.current&&r.current&&r.current()}),[])},R=()=>{const{onAuthenticated:a,redirectOnAuthenticated:r}=p(),t=k(),n=t.get("token"),i=t.get("redir"),[o,c]=s.useState(null),l=y({onSuccess:u=>{a(u),r(i)},onError:u=>{c(A(u))}});return S(()=>{n?l.mutate({token:n}):c("Invalid token.")}),o?e.jsxs(e.Fragment,{children:[e.jsx(x,{color:"danger mt-3",children:o}),e.jsx("br",{}),e.jsx(g,{to:"/",children:"Home"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-dark",children:"Authenticating."}),e.jsx("div",{className:"spinner-full",children:e.jsx(j,{color:"primary"})})]})};export{R as default};
//# sourceMappingURL=PasswordlessLoginPage-DZq87Urc.js.map
