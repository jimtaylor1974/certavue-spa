import{b as j,l as v,d as g,h as y,z as L,c as P,u as R,k as U,r as x,j as e,E as A,B as a,bw as M,L as D,b7 as l}from"./index-C-RVz6Ax.js";import{B as z}from"./ButtonGroup-DT5l3ZVs.js";import{C as q,a as B}from"./CardBody-sAodfdc3.js";import{T as G}from"./Table-cGpuXjD_.js";import{g as I,P as Q}from"./Pagination-Cn7sBGr6.js";import{S as W}from"./Spinner-04NgOIJH.js";import{S as K}from"./Search-BXjbuZ6y.js";import{u as H}from"./useLocalStorage-6Pc1th0h.js";import{F as O,a as V}from"./file-pen-DhyMG0fX.js";import{P as _}from"./plus-BeEwXAPw.js";import{T as J}from"./trash-2-CKPOwWdS.js";import{E as X}from"./eye-B_GKup94.js";import"./Label-jeggPgyg.js";import"./search-61-41lqe.js";import"./chevron-left-D-_6Mten.js";import"./InputGroupText-PEG7w4Sz.js";const Y=(t,o,n,r,c)=>{const i=["pagedMarkdownDocuments",{documentGroup:t,directoryPath:o,search:n,pagination:r}],d=`${g}/api/markdown-documents/paged?documentGroup=${encodeURIComponent(t)}&directoryPath=${encodeURIComponent(o)}&page=${r.page}&perPage=${r.perPage}&search=${n==null?"":encodeURIComponent(n)}`,m=j();return v({queryKey:i,queryFn:async()=>{const p=await m(d);return y(p)},...c})},Z=t=>{const o=j(),n=L();return P({mutationFn:async r=>{const c=await o(`${g}/api/markdown-documents/${r}`,{method:"DELETE"});return y(c)},onSuccess:()=>{n.invalidateQueries({queryKey:["markdownDocument"]})},...t})},ee=t=>{const o=j();return P({mutationFn:async()=>{const n=await o(`${g}/api/markdown-documents/write-to-sln-docs`,{method:"POST",headers:{"Content-Type":"application/json"}});return y(n)},...t})},ge=()=>{const[t,o]=H("documentGroup","docs"),n=R(),r=U(),[c,i]=x.useState(1),[d,m]=x.useState(I()),[h,p]=x.useState(""),{data:u,error:f,isLoading:E,refetch:w}=Y(t,"",h,{page:c,perPage:d},{enabled:n.isAuthenticated}),C=Z({onSuccess:()=>{l.success("Document deleted successfully"),w()},onError:s=>{l.error(`Error deleting document: ${s.message}`)}}),S=ee({onSuccess:()=>{l.success("System documentation successfully written to solution docs folder")},onError:s=>{l.error(`Error writing to solution docs: ${s.message}`)}}),N=(s,T)=>{window.confirm(`Are you sure you want to delete document "${T}"?`)&&C.mutate(s)},$=s=>{i(1),m(s)},k=s=>t==="sys"?`/sysdocs/${s}`:`/documents/${s}`,F=s=>`/sysadmin/documents/edit/${s}`,b=()=>"/sysadmin/documents/edit/_";return E?e.jsx(W,{}):f?e.jsx(A,{error:f,title:"Unable to fetch documents",onDismiss:()=>w()}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Documentation"}),e.jsxs(z,{className:"mt-2",children:[e.jsx(a,{color:t==="docs"?"primary":"secondary",onClick:()=>o("docs"),children:"Documents"}),e.jsx(a,{color:t==="sys"?"primary":"secondary",onClick:()=>o("sys"),children:"System"})]})]}),e.jsxs("div",{className:"d-flex",children:[t==="sys"&&M&&e.jsxs(a,{color:"success",className:"me-2",onClick:()=>S.mutate(),disabled:S.isPending,children:[e.jsx(O,{size:18,className:"me-2"})," Write to Sln Docs"]}),e.jsxs(a,{color:"primary",onClick:()=>r(b()),children:[e.jsx(_,{size:18,className:"me-2"})," New Document"]})]})]}),e.jsx(q,{className:"mb-4",children:e.jsx(B,{children:e.jsx(K,{searchText:h,onSearch:p})})}),u&&e.jsxs(e.Fragment,{children:[e.jsxs(G,{responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Path"}),e.jsx("th",{children:"Last Modified"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[u.items.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.path}),e.jsx("td",{children:new Date(s.updatedAt||s.createdAt).toLocaleString()}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex",children:[e.jsx(a,{color:"primary",outline:!0,className:"me-2",tag:D,to:F(s.id),children:e.jsx(V,{size:18})}),e.jsx(a,{color:"danger",outline:!0,className:"me-2",onClick:()=>N(s.id,s.path),children:e.jsx(J,{size:18})}),e.jsx(a,{color:"info",outline:!0,tag:D,to:k(s.path),children:e.jsx(X,{size:18})})]})})]},s.id)),u.items.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-3",children:"No documents found."})})]})]}),e.jsx(Q,{pagedResult:u,onPageSelected:i,perPage:d,onPerPageSelected:$})]})]})};export{ge as default};
//# sourceMappingURL=EditDocumentsPage-vHeogQes.js.map
