{"version":3,"file":"MsAuthPage-bxU6rbJN.js","sources":["../../src/components/social_logins/MsAuthPage.tsx"],"sourcesContent":["import {useState, useEffect} from 'react';\r\nimport ErrorDisplay from '../utility/ErrorDisplay';\r\nimport Spinner from '../utility/Spinner';\r\nimport {\r\n    LoginProvider,\r\n    SocialAuthResult,\r\n    SocialAuthLoginCommand\r\n} from '../../types';\r\nimport useSocialAuthLogin from '../../api/auth/useSocialAuthLogin';\r\n\r\nconst MsAuthPage = () => {\r\n    const [apiError, setApiError] = useState<unknown>(null);\r\n\r\n    const {mutate: socialAuthMutate, isPending: awaitingResponse} =\r\n        useSocialAuthLogin({\r\n            onSuccess: (socialAuthResult: SocialAuthResult) => {\r\n                if (\r\n                    socialAuthResult.authError &&\r\n                    socialAuthResult.authError.error !== 'invalid_grant'\r\n                ) {\r\n                    setApiError(socialAuthResult.authError);\r\n                    return;\r\n                }\r\n\r\n                window.opener.onSocialAuthLogin(socialAuthResult);\r\n                window.close();\r\n            },\r\n            onError: (error: unknown) => {\r\n                setApiError(error);\r\n            }\r\n        });\r\n\r\n    const hash = window.location.hash;\r\n\r\n    useEffect(() => {\r\n        if (hash.indexOf('#') !== -1) {\r\n            const queryString = hash.substr(1).split('&');\r\n            const accessToken = queryString[0].split('=')[1];\r\n\r\n            const auth: SocialAuthLoginCommand = {\r\n                provider: LoginProvider.Microsoft,\r\n                token: accessToken\r\n            };\r\n\r\n            socialAuthMutate(auth);\r\n        }\r\n    }, [hash, socialAuthMutate]);\r\n\r\n    return (\r\n        <div className=\"container\">\r\n            {awaitingResponse && !apiError && <Spinner />}\r\n            <ErrorDisplay error={apiError} />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default MsAuthPage;\r\n"],"names":["MsAuthPage","apiError","setApiError","useState","socialAuthMutate","awaitingResponse","useSocialAuthLogin","socialAuthResult","error","hash","useEffect","accessToken","auth","LoginProvider","jsxs","jsx","Spinner","ErrorDisplay"],"mappings":"6LAUA,MAAMA,EAAa,IAAM,CACrB,KAAM,CAACC,EAAUC,CAAW,EAAIC,EAAAA,SAAkB,IAAI,EAEhD,CAAC,OAAQC,EAAkB,UAAWC,CAAA,EACxCC,EAAmB,CACf,UAAYC,GAAuC,CAC/C,GACIA,EAAiB,WACjBA,EAAiB,UAAU,QAAU,gBACvC,CACEL,EAAYK,EAAiB,SAAS,EACtC,MAAA,CAGG,OAAA,OAAO,kBAAkBA,CAAgB,EAChD,OAAO,MAAM,CACjB,EACA,QAAUC,GAAmB,CACzBN,EAAYM,CAAK,CAAA,CACrB,CACH,EAECC,EAAO,OAAO,SAAS,KAE7BC,OAAAA,EAAAA,UAAU,IAAM,CACZ,GAAID,EAAK,QAAQ,GAAG,IAAM,GAAI,CAE1B,MAAME,EADcF,EAAK,OAAO,CAAC,EAAE,MAAM,GAAG,EACZ,CAAC,EAAE,MAAM,GAAG,EAAE,CAAC,EAEzCG,EAA+B,CACjC,SAAUC,EAAc,UACxB,MAAOF,CACX,EAEAP,EAAiBQ,CAAI,CAAA,CACzB,EACD,CAACH,EAAML,CAAgB,CAAC,EAGvBU,EAAA,KAAC,MAAI,CAAA,UAAU,YACV,SAAA,CAAoBT,GAAA,CAACJ,GAAYc,MAACC,EAAQ,CAAA,CAAA,EAC3CD,EAAAA,IAACE,EAAa,CAAA,MAAOhB,CAAU,CAAA,CAAA,EACnC,CAER"}