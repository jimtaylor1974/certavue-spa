import{b as I,c as q,d as v,h as z,k as D,r as c,j as s,G,y as l,I as P,A as L,B as T,b6 as A,b7 as B}from"./index-C-RVz6Ax.js";import{u as O}from"./useRouteQuery-ZTIFPnyP.js";import{u as M,C as f,D as p}from"./DisplayFormError-ye2fRgMX.js";import{F as h,L as x}from"./Label-jeggPgyg.js";import{I as j}from"./InputGroupText-PEG7w4Sz.js";import{E as y}from"./eye-off-I1-L4AWu.js";import{E as g}from"./eye-B_GKup94.js";const J=e=>{const o=I();return q({mutationFn:async a=>{const t=await o(`${v}/api/auth/reset-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});return z(t)},...e})};function W(){const e=D(),o=O(),a=o.get("user_id"),t=o.get("token"),[w,m]=c.useState(null),[i,C]=c.useState(!1),[d,S]=c.useState(!1),E=J({onSuccess:()=>{B.success("Password reset."),e("/login")},onError:r=>{m(A(r))}}),{control:u,handleSubmit:b,formState:{errors:n},clearErrors:N,watch:F}=M({defaultValues:{newPassword:"",confirmPassword:""},mode:"onChange"});a&&t||e("/login");const k=r=>{m(null),N();const R={userId:a,token:t,newPassword:r.newPassword,confirmPassword:r.confirmPassword};E.mutate(R)};return s.jsxs(s.Fragment,{children:[s.jsx("h1",{children:"Reset Password"}),s.jsxs(G,{onSubmit:b(k),children:[s.jsxs(h,{children:[s.jsx(x,{for:"newPassword",children:"New Password"}),s.jsxs(l,{children:[s.jsx(f,{name:"newPassword",control:u,rules:{required:"New Password is required"},render:({field:r})=>s.jsx(P,{...r,type:i?"text":"password",id:"newPassword",maxLength:512,invalid:!!n.newPassword})}),s.jsx(j,{style:{cursor:"pointer"},onClick:()=>C(!i),children:i?s.jsx(y,{size:20}):s.jsx(g,{size:20})})]}),s.jsx(p,{error:n.newPassword,fieldDisplayName:"New Password"})]}),s.jsxs(h,{children:[s.jsx(x,{for:"confirmPassword",children:"Confirm Password"}),s.jsxs(l,{children:[s.jsx(f,{name:"confirmPassword",control:u,rules:{required:"Confirm Password is required",validate:r=>r===F("newPassword")||"Passwords do not match"},render:({field:r})=>s.jsx(P,{...r,type:d?"text":"password",id:"confirmPassword",maxLength:512,invalid:!!n.confirmPassword})}),s.jsx(j,{style:{cursor:"pointer"},onClick:()=>S(!d),children:d?s.jsx(y,{size:20}):s.jsx(g,{size:20})})]}),s.jsx(p,{error:n.confirmPassword,fieldDisplayName:"Confirm Password"})]}),w&&s.jsx(L,{color:"danger",className:"mt-3",children:w}),s.jsx(T,{type:"submit",color:"primary",className:"mt-3",children:"Reset Password"})]})]})}export{W as default};
//# sourceMappingURL=ResetPasswordPage-DQ-RapBS.js.map
