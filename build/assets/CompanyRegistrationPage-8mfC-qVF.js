import{b as xe,c as pe,d as ue,h as Ne,u as be,r as B,k as fe,j as e,e as H,C as W,B as l,F as ge,N as ye,a as S,b9 as $,ba as _,U as Ce,G as ve,I as u,A as K,b6 as Q,b7 as U}from"./index-C-RVz6Ax.js";import{u as Te,a as we,C as h,D as A}from"./DisplayFormError-ye2fRgMX.js";import{R as v,C as o}from"./Col-BQD9N-5w.js";import{C as N,a as b}from"./CardBody-sAodfdc3.js";import{F as x,L as p}from"./Label-jeggPgyg.js";import{F as ke}from"./FormText-DwCcsiID.js";import{T as Ae,a as z}from"./TabPane-CbDxWlLd.js";import{i as y}from"./isNullOrWhiteSpace-D2HOxx4J.js";import{T as Re}from"./TermsAndConditions-CnB805Kc.js";import{C as X}from"./types-46npvi_j.js";import{T as Ee}from"./TimeZoneSelect-DtME5Hqs.js";import{c as ee}from"./customerRoleOptions-BPtwxekR.js";import{P as se}from"./plus-BeEwXAPw.js";import{L as Fe}from"./log-in-BqCIGAHl.js";import{B as Pe,C as Se,T as $e,a as ze}from"./triangle-alert-Cbv6VdP1.js";import{T as Ie}from"./trash-2-CKPOwWdS.js";import"./createClass-Dt39cmSc.js";import"./floating-ui.dom-B64eMHnB.js";const Ze=R=>{const F=xe();return pe({mutationFn:async I=>{const f=await F(`${ue}/api/customers/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)});return Ne(f)},...R})},ss=()=>{const{isAuthenticated:R,setSignInRedirect:F,onAuthenticated:I,givenName:f,familyName:T,email:w}=be(),[k,ae]=B.useState("1"),[Y,J]=B.useState(null),Z=fe(),re=Intl.DateTimeFormat().resolvedOptions().timeZone,{control:i,handleSubmit:ne,watch:te,formState:{errors:g},setValue:E,trigger:D}=Te({mode:"onChange",defaultValues:{companyName:"",timeZone:re,firstName:"",lastName:"",email:"",jobTitle:"",phoneNumber:"",additionalContacts:[],acceptTerms:!1}}),{fields:L,append:ie,remove:le}=we({control:i,name:"additionalContacts"}),n=te();B.useEffect(()=>{R&&f&&T&&w&&(E("firstName",f),E("lastName",T),E("email",w))},[R,f,T,w,E]);const q=Ze({onSuccess:s=>{U.success("Company registration successful! You are now signed up for the free trial."),s.authTokens?(I(s.authTokens),Z("/register-company-completed")):U.error(Q(s.authError))},onError:s=>{J(Q(s)),U.error("There was an error processing your subscription.")}}),oe=()=>{let s=0;return!y(n.companyName)&&!y(n.timeZone)&&(s+=30),!y(n.firstName)&&!y(n.lastName)&&!y(n.email)&&(s+=30),n.acceptTerms&&(s+=40),s},j=async s=>{const a=parseInt(k);if(parseInt(s)>a){let c=!1;if(a===1?c=await D(["companyName","timeZone"]):a===2?c=await D(["firstName","lastName","email"]):c=!0,!c)return}ae(s)},ce=()=>{ie({firstName:"",lastName:"",email:"",jobTitle:"",phoneNumber:"",roles:[]})},me=s=>{J(null);const a={customerName:s.companyName,timeZone:s.timeZone,administratorContact:{firstName:f||"",lastName:T||"",email:w||"",jobTitle:s.jobTitle||"",phoneNumber:s.phoneNumber||"",roles:[X.Administrator]},additionalContacts:s.additionalContacts.filter(t=>!y(t.firstName)&&!y(t.lastName)&&!y(t.email))};q.mutate(a)},de=(s,a)=>{const t=n.additionalContacts[s].roles||[],c=t.includes(a)?t.filter(C=>C!==a):[...t,a];E(`additionalContacts.${s}.roles`,c)},he=()=>{F("/register-company"),Z("/login")},je=()=>{F("/register-company"),Z("/sign-up")};return R?e.jsx(H,{className:"mt-5 mb-5",children:e.jsx(v,{className:"justify-content-center",children:e.jsxs(o,{xs:12,md:10,lg:8,children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx(W,{}),e.jsx("h2",{className:"mt-3",children:"Company Registration"}),e.jsx("p",{className:"text-muted",children:"Register your company for certavue"}),e.jsx(ge,{className:"mt-4",value:oe()}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{children:"Company Details"}),e.jsx("span",{children:"Contact Details"}),e.jsx("span",{children:"Additional Contacts"}),e.jsx("span",{children:"Review & Confirm"})]})]}),e.jsx(N,{children:e.jsxs(b,{children:[e.jsxs(ye,{tabs:!0,className:"mb-4",children:[e.jsx(S,{children:e.jsxs($,{className:k==="1"?"active":"",onClick:()=>j("1"),children:[e.jsx(Pe,{size:16,className:"me-2"}),"Company"]})}),e.jsx(S,{children:e.jsxs($,{className:k==="2"?"active":"",onClick:()=>j("2"),children:[e.jsx(_,{size:16,className:"me-2"}),"Contact Details"]})}),e.jsx(S,{children:e.jsxs($,{className:k==="3"?"active":"",onClick:()=>j("3"),children:[e.jsx(Ce,{size:16,className:"me-2"}),"Additional Contacts"]})}),e.jsx(S,{children:e.jsxs($,{className:k==="4"?"active":"",onClick:()=>j("4"),children:[e.jsx(Se,{size:16,className:"me-2"}),"Review & Confirm"]})})]}),e.jsx(ve,{onSubmit:ne(me),children:e.jsxs(Ae,{activeTab:k,children:[e.jsxs(z,{tabId:"1",children:[e.jsx("h5",{className:"mb-3",children:"Company Information"}),e.jsxs(x,{children:[e.jsx(p,{for:"companyName",children:"Company Name *"}),e.jsx(h,{name:"companyName",control:i,rules:{required:"Company name is required"},render:({field:s})=>e.jsx(u,{...s,type:"text",id:"companyName",placeholder:"Enter your company name",invalid:!!g.companyName})}),e.jsx(A,{error:g.companyName,fieldDisplayName:"Company Name"})]}),e.jsx(h,{name:"timeZone",control:i,rules:{required:"Time zone is required"},render:({field:s,fieldState:a})=>e.jsxs(e.Fragment,{children:[e.jsx(Ee,{value:s.value,onChange:s.onChange,className:"mb-3",label:"Timezone"}),a.error&&e.jsx(A,{error:a.error,fieldDisplayName:"Time Zone"})]})}),e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx(l,{color:"primary",onClick:()=>j("2"),disabled:!n.companyName||!n.timeZone,children:"Next: Primary Contact"})})]}),e.jsxs(z,{tabId:"2",children:[e.jsx("h5",{className:"mb-3",children:"Primary Contact Information"}),e.jsx("p",{className:"text-muted small mb-3",children:"This person will be assigned the Administrator role."}),e.jsxs("div",{className:"mb-4 p-3 bg-light rounded",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(_,{size:18,className:"me-2 text-primary"}),e.jsx("strong",{children:"Your Account Information"})]}),e.jsxs(v,{className:"mt-3",children:[e.jsx(o,{md:6,children:e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"First Name:"})," ",f]})}),e.jsx(o,{md:6,children:e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"Last Name:"})," ",T]})})]}),e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"Email:"})," ",w]})]}),e.jsxs(v,{children:[e.jsx(o,{md:6,children:e.jsxs(x,{children:[e.jsx(p,{for:"jobTitle",children:"Job Title"}),e.jsx(h,{name:"jobTitle",control:i,render:({field:s})=>e.jsx(u,{...s,type:"text",id:"jobTitle",placeholder:"Enter job title"})})]})}),e.jsx(o,{md:6,children:e.jsxs(x,{children:[e.jsx(p,{for:"phoneNumber",children:"Phone Number"}),e.jsx(h,{name:"phoneNumber",control:i,render:({field:s})=>e.jsx(u,{...s,type:"tel",id:"phoneNumber",placeholder:"Enter phone number"})})]})})]}),e.jsxs("div",{className:"d-flex justify-content-between mt-4",children:[e.jsx(l,{color:"secondary",outline:!0,onClick:()=>j("1"),children:"Back"}),e.jsx(l,{color:"primary",onClick:()=>j("3"),children:"Next: Additional Contacts"})]})]}),e.jsxs(z,{tabId:"3",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsx("h5",{className:"mb-0",children:"Additional Contacts"}),e.jsxs(l,{color:"primary",size:"sm",outline:!0,onClick:ce,children:[e.jsx(se,{size:16,className:"me-1"})," ","Add Contact"]})]}),e.jsx("p",{className:"text-muted small mb-4",children:"Add team members who will have different roles in your company. You can assign multiple roles to each contact, and team members can be added or updated after your company registration is complete."}),L.length===0&&e.jsx(K,{color:"info",className:"mb-4",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx($e,{size:20,className:"me-2"}),e.jsx("span",{children:"No additional contacts added yet. You can add contacts now or later."})]})}),L.map((s,a)=>{var t,c,C,P,O,V;return e.jsx(N,{className:"mb-4 border",children:e.jsxs(b,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("h6",{className:"mb-0",children:["Contact #",a+1]}),e.jsx(l,{color:"danger",size:"sm",outline:!0,onClick:()=>le(a),children:e.jsx(Ie,{size:16})})]}),e.jsxs(v,{children:[e.jsx(o,{md:6,children:e.jsxs(x,{children:[e.jsx(p,{for:`contact-firstName-${a}`,children:"First Name *"}),e.jsx(h,{name:`additionalContacts.${a}.firstName`,control:i,rules:{required:"First name is required"},render:({field:r})=>{var m,d;return e.jsx(u,{...r,type:"text",id:`contact-firstName-${a}`,placeholder:"Enter first name",invalid:!!((d=(m=g.additionalContacts)==null?void 0:m[a])!=null&&d.firstName)})}}),e.jsx(A,{error:(c=(t=g.additionalContacts)==null?void 0:t[a])==null?void 0:c.firstName,fieldDisplayName:"First Name"})]})}),e.jsx(o,{md:6,children:e.jsxs(x,{children:[e.jsx(p,{for:`contact-lastName-${a}`,children:"Last Name *"}),e.jsx(h,{name:`additionalContacts.${a}.lastName`,control:i,rules:{required:"Last name is required"},render:({field:r})=>{var m,d;return e.jsx(u,{...r,type:"text",id:`contact-lastName-${a}`,placeholder:"Enter last name",invalid:!!((d=(m=g.additionalContacts)==null?void 0:m[a])!=null&&d.lastName)})}}),e.jsx(A,{error:(P=(C=g.additionalContacts)==null?void 0:C[a])==null?void 0:P.lastName,fieldDisplayName:"Last Name"})]})})]}),e.jsxs(x,{children:[e.jsx(p,{for:`contact-email-${a}`,children:"Email *"}),e.jsx(h,{name:`additionalContacts.${a}.email`,control:i,rules:{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}},render:({field:r})=>{var m,d;return e.jsx(u,{...r,type:"email",id:`contact-email-${a}`,placeholder:"Enter email address",invalid:!!((d=(m=g.additionalContacts)==null?void 0:m[a])!=null&&d.email)})}}),e.jsx(A,{error:(V=(O=g.additionalContacts)==null?void 0:O[a])==null?void 0:V.email,fieldDisplayName:"Email"})]}),e.jsxs(v,{children:[e.jsx(o,{md:6,children:e.jsxs(x,{children:[e.jsx(p,{for:`contact-jobTitle-${a}`,children:"Job Title"}),e.jsx(h,{name:`additionalContacts.${a}.jobTitle`,control:i,render:({field:r})=>e.jsx(u,{...r,type:"text",id:`contact-jobTitle-${a}`,placeholder:"Enter job title"})})]})}),e.jsx(o,{md:6,children:e.jsxs(x,{children:[e.jsx(p,{for:`contact-phoneNumber-${a}`,children:"Phone Number"}),e.jsx(h,{name:`additionalContacts.${a}.phoneNumber`,control:i,render:({field:r})=>e.jsx(u,{...r,type:"tel",id:`contact-phoneNumber-${a}`,placeholder:"Enter phone number"})})]})})]}),e.jsxs(x,{children:[e.jsx(p,{children:"Roles"}),e.jsx("div",{className:"d-flex flex-wrap gap-2",children:ee.filter(r=>r.value!==X.Administrator).map(r=>{var m,d,M,G;return e.jsxs(l,{type:"button",color:(d=(m=n.additionalContacts[a])==null?void 0:m.roles)!=null&&d.includes(r.value)?"primary":"secondary",size:"sm",className:"mb-2",onClick:()=>de(a,r.value),children:[((G=(M=n.additionalContacts[a])==null?void 0:M.roles)==null?void 0:G.includes(r.value))&&e.jsx(ze,{size:14,className:"me-1"}),r.label.split(" (")[0]]},r.value)})}),e.jsx(ke,{children:"Select the roles this contact will have in your organization."}),e.jsx(h,{name:`additionalContacts.${a}.roles`,control:i,rules:{validate:r=>r&&r.length>0||"At least one role must be selected"},render:({fieldState:{error:r}})=>r?e.jsx(A,{error:r,fieldDisplayName:"Roles"}):e.jsx(e.Fragment,{})})]})]})},s.id)}),e.jsxs("div",{className:"d-flex justify-content-between mt-4",children:[e.jsx(l,{color:"secondary",outline:!0,onClick:()=>j("2"),children:"Back"}),e.jsx(l,{color:"primary",onClick:async()=>{await D("additionalContacts")&&j("4")},children:"Next: Review"})]})]}),e.jsxs(z,{tabId:"4",children:[e.jsx("h5",{className:"mb-4",children:"Review Your Information"}),e.jsx(N,{className:"mb-4 bg-light",children:e.jsxs(b,{children:[e.jsx("h6",{className:"mb-3",children:"Company Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Company Name:"})," ",n.companyName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Timezone:"})," ",n.timeZone]})]})}),e.jsx(N,{className:"mb-4 bg-light",children:e.jsxs(b,{children:[e.jsx("h6",{className:"mb-3",children:"Primary Contact"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",f," ",T]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",w]}),n.jobTitle&&e.jsxs("p",{children:[e.jsx("strong",{children:"Job Title:"})," ",n.jobTitle]}),n.phoneNumber&&e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," ",n.phoneNumber]})]})}),L.length>0&&e.jsx(N,{className:"mb-4 bg-light",children:e.jsxs(b,{children:[e.jsx("h6",{className:"mb-3",children:"Additional Contacts"}),n.additionalContacts.map((s,a)=>{var t;return e.jsxs("div",{className:"mb-3 pb-3 border-bottom",children:[e.jsxs("p",{className:"mb-1",children:[e.jsxs("strong",{children:["Contact #",a+1,":"]})," ",s.firstName," ",s.lastName]}),e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"Email:"})," ",s.email]}),s.jobTitle&&e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"Job Title:"})," ",s.jobTitle]}),s.phoneNumber&&e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"Phone:"})," ",s.phoneNumber]}),e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"Roles:"})," ",((t=s.roles)==null?void 0:t.length)>0?s.roles.map(c=>{var C;return(C=ee.find(P=>P.value===c))==null?void 0:C.label.split(" (")[0]}).join(", "):"None assigned"]})]},a)})]})}),e.jsx(N,{className:"mb-4 bg-light",children:e.jsxs(b,{children:[e.jsx("h6",{className:"mb-3",children:"Subscription"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Plan:"})," Free Trial"]}),e.jsx("p",{className:"text-muted small",children:"Your free trial gives you full access to all features of Certavue for evaluation purposes."})]})}),e.jsx("div",{style:{maxHeight:"200px",overflow:"auto",border:"1px solid #ced4da",borderRadius:".25rem",padding:"10px",marginBottom:"20px"},children:e.jsx(Re,{})}),e.jsxs(x,{check:!0,className:"mb-4",children:[e.jsx(h,{name:"acceptTerms",control:i,rules:{required:!0},render:({field:s})=>e.jsx(u,{type:"checkbox",id:"acceptTerms",checked:s.value,onChange:a=>s.onChange(a.target.checked)})}),e.jsx(p,{for:"acceptTerms",check:!0,children:"I have read and accept the Terms and Conditions"})]}),Y&&e.jsx(K,{color:"danger",className:"mb-4",children:Y}),e.jsxs("div",{className:"d-flex justify-content-between mt-4",children:[e.jsx(l,{color:"secondary",outline:!0,onClick:()=>j("3"),children:"Back"}),e.jsx(l,{type:"submit",color:"success",disabled:!n.acceptTerms||q.isPending,children:q.isPending?"Processing...":"Complete Registration"})]})]})]})})]})})]})})}):e.jsx(H,{className:"mt-5 mb-5",children:e.jsx(v,{className:"justify-content-center",children:e.jsxs(o,{xs:12,md:8,lg:6,children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx(W,{}),e.jsx("h2",{className:"mt-3",children:"Company Registration"}),e.jsx("p",{className:"text-muted",children:"Register your company for certavue"})]}),e.jsx(N,{children:e.jsxs(b,{className:"p-4",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h4",{children:"Create a Personal User Login First"}),e.jsx("p",{children:"To register your company, you need a personal user login. This is separate from your company account."})]}),e.jsxs(v,{className:"mt-4",children:[e.jsx(o,{md:6,className:"mb-3 mb-md-0",children:e.jsx(N,{className:"h-100 border",children:e.jsxs(b,{className:"d-flex flex-column",children:[e.jsx("h5",{children:"New User?"}),e.jsx("p",{className:"flex-grow-1",children:"Create a personal user login to begin registering your company. This creates only your personal login, not the company account."}),e.jsxs(l,{color:"primary",block:!0,onClick:je,className:"mt-auto",children:[e.jsx(se,{size:16,className:"me-2"}),"Create User Login"]})]})})}),e.jsx(o,{md:6,children:e.jsx(N,{className:"h-100 border",children:e.jsxs(b,{className:"d-flex flex-column",children:[e.jsx("h5",{children:"Existing User?"}),e.jsx("p",{className:"flex-grow-1",children:"Sign in with your personal login to continue with your company registration."}),e.jsxs(l,{color:"secondary",block:!0,onClick:he,className:"mt-auto",children:[e.jsx(Fe,{size:16,className:"me-2"}),"Sign in to User Account"]})]})})})]}),e.jsx("div",{className:"text-center mt-4",children:e.jsx("p",{className:"text-muted small",children:"After signing in with your personal user login, you'll be redirected back to complete your company registration."})})]})})]})})})};export{ss as default};
//# sourceMappingURL=CompanyRegistrationPage-8mfC-qVF.js.map
