import{r as p,j as r,D as Q,n as X,I as T,H as Y,o as ee,B as F}from"./index-CdmDVAN5.js";import{u as te,D as z,n as ne,P as w,a as se,f as M,T as U}from"./tags-CaVCOdLe.js";import{S as ae}from"./search-BjYPSpAX.js";import{P as re}from"./plus-BJMe9uVY.js";import{v as le}from"./v4-C6aID195.js";const ie=6048e5,ce=864e5,L=6e4,W=36e5,Ee=1e3,E=Symbol.for("constructDateFrom");function N(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&E in t?t[E](e):t instanceof Date?new t.constructor(e):new Date(e)}function g(t,e){return N(e||t,t)}function Re(t,e,n){const s=g(t,n==null?void 0:n.in);return isNaN(e)?N((n==null?void 0:n.in)||t,NaN):(e&&s.setDate(s.getDate()+e),s)}let oe={};function ue(){return oe}function de(t,e){var u,o,d,c;const n=ue(),s=(e==null?void 0:e.weekStartsOn)??((o=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:o.weekStartsOn)??n.weekStartsOn??((c=(d=n.locale)==null?void 0:d.options)==null?void 0:c.weekStartsOn)??0,l=g(t,e==null?void 0:e.in),i=l.getDay(),m=(i<s?7:0)+i-s;return l.setDate(l.getDate()-m),l.setHours(0,0,0,0),l}function y(t,e){return de(t,{...e,weekStartsOn:1})}function me(t,e){const n=g(t,e==null?void 0:e.in),s=n.getFullYear(),l=N(n,0);l.setFullYear(s+1,0,4),l.setHours(0,0,0,0);const i=y(l),m=N(n,0);m.setFullYear(s,0,4),m.setHours(0,0,0,0);const u=y(m);return n.getTime()>=i.getTime()?s+1:n.getTime()>=u.getTime()?s:s-1}function R(t){const e=g(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function $(t,...e){const n=N.bind(null,e.find(s=>typeof s=="object"));return e.map(n)}function _(t,e){const n=g(t,e==null?void 0:e.in);return n.setHours(0,0,0,0),n}function fe(t,e,n){const[s,l]=$(n==null?void 0:n.in,t,e),i=_(s),m=_(l),u=+i-R(i),o=+m-R(m);return Math.round((u-o)/ce)}function ge(t,e){const n=me(t,e),s=N(t,0);return s.setFullYear(n,0,4),s.setHours(0,0,0,0),y(s)}function he(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function _e(t){return!(!he(t)&&typeof t!="number"||isNaN(+g(t)))}function He(t,e,n){const[s,l]=$(n==null?void 0:n.in,t,e),i=H(s,l),m=Math.abs(fe(s,l));s.setDate(s.getDate()-i*m);const u=+(H(s,l)===-i),o=i*(m-u);return o===0?0:o}function H(t,e){const n=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return n<0?-1:n>0?1:n}function Le(t,e){const n=g(t,e==null?void 0:e.in),s=+y(n)-+ge(n);return Math.round(s/ie)+1}function We(t,e){return g(t,e==null?void 0:e.in).getFullYear()}function $e(t,e){const n=()=>N(e==null?void 0:e.in,NaN),l=De(t);let i;if(l.date){const d=je(l.date,2);i=ye(d.restDateString,d.year)}if(!i||isNaN(+i))return n();const m=+i;let u=0,o;if(l.time&&(u=be(l.time),isNaN(u)))return n();if(l.timezone){if(o=Te(l.timezone),isNaN(o))return n()}else{const d=new Date(m+u),c=g(0,e==null?void 0:e.in);return c.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),c.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),c}return g(m+u+o,e==null?void 0:e.in)}const j={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},xe=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Ne=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,pe=/^([+-])(\d{2})(?::?(\d{2}))?$/;function De(t){const e={},n=t.split(j.dateTimeDelimiter);let s;if(n.length>2)return e;if(/:/.test(n[0])?s=n[0]:(e.date=n[0],s=n[1],j.timeZoneDelimiter.test(e.date)&&(e.date=t.split(j.timeZoneDelimiter)[0],s=t.substr(e.date.length,t.length))),s){const l=j.timezone.exec(s);l?(e.time=s.replace(l[1],""),e.timezone=l[1]):e.time=s}return e}function je(t,e){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),s=t.match(n);if(!s)return{year:NaN,restDateString:""};const l=s[1]?parseInt(s[1]):null,i=s[2]?parseInt(s[2]):null;return{year:i===null?l:i*100,restDateString:t.slice((s[1]||s[2]).length)}}function ye(t,e){if(e===null)return new Date(NaN);const n=t.match(xe);if(!n)return new Date(NaN);const s=!!n[4],l=D(n[1]),i=D(n[2])-1,m=D(n[3]),u=D(n[4]),o=D(n[5])-1;if(s)return Ie(e,u,o)?we(e,u,o):new Date(NaN);{const d=new Date(0);return!Se(e,i,m)||!Ce(e,l)?new Date(NaN):(d.setUTCFullYear(e,i,Math.max(l,m)),d)}}function D(t){return t?parseInt(t):1}function be(t){const e=t.match(Ne);if(!e)return NaN;const n=v(e[1]),s=v(e[2]),l=v(e[3]);return Oe(n,s,l)?n*W+s*L+l*1e3:NaN}function v(t){return t&&parseFloat(t.replace(",","."))||0}function Te(t){if(t==="Z")return 0;const e=t.match(pe);if(!e)return 0;const n=e[1]==="+"?-1:1,s=parseInt(e[2]),l=e[3]&&parseInt(e[3])||0;return ke(s,l)?n*(s*W+l*L):NaN}function we(t,e,n){const s=new Date(0);s.setUTCFullYear(t,0,4);const l=s.getUTCDay()||7,i=(e-1)*7+n+1-l;return s.setUTCDate(s.getUTCDate()+i),s}const ve=[31,null,31,30,31,30,31,31,30,31,30,31];function P(t){return t%400===0||t%4===0&&t%100!==0}function Se(t,e,n){return e>=0&&e<=11&&n>=1&&n<=(ve[e]||(P(t)?29:28))}function Ce(t,e){return e>=1&&e<=(P(t)?366:365)}function Ie(t,e,n){return e>=1&&e<=53&&n>=0&&n<=6}function Oe(t,e,n){return t===24?e===0&&n===0:n>=0&&n<60&&e>=0&&e<60&&t>=0&&t<25}function ke(t,e){return e>=0&&e<=59}const Pe=({selectedTags:t,onChange:e,placeholder:n="Select tags...",isLoading:s=!1,className:l="",allowCreate:i=!1})=>{const[m,u]=p.useState(!1),[o,d]=p.useState(""),[c,h]=p.useState(null),Z=p.useRef(null),A=p.useRef(null),{data:S=[],isLoading:C}=te(!0),I=S.filter(a=>{const f=t.some(k=>k.id===a.id&&k.id!==null),x=a.name.toLowerCase().includes(o.toLowerCase());return!f&&x}),b=i&&o.trim()&&!S.some(a=>a.name.toLowerCase()===o.toLowerCase())&&!t.some(a=>a.name.toLowerCase()===o.toLowerCase()),B=a=>{e([...t,a]),d(""),u(!1)},J=a=>{e(t.filter(f=>"tempId"in a&&"tempId"in f?f.tempId!==a.tempId:f.id!==a.id))},O=()=>{const a=M(o.trim());if(!a)return;const f={id:null,name:a,colour:w[Math.floor(Math.random()*w.length)],icon:U.icon,isActive:U.isActive,tempId:le()};e([...t,f]),d(""),u(!1)},G=a=>{i&&a.id===null&&h({...a})},K=()=>{if(!c)return;const a={...c,name:M(c.name)};if(!a.name)return;const f=t.map(x=>"tempId"in x&&"tempId"in c&&x.tempId===c.tempId||x.id&&c.id&&x.id===c.id?a:x);e(f),h(null)},q=()=>{u(!0)},V=a=>{a.key==="Enter"&&b?(a.preventDefault(),O()):a.key==="Escape"&&(u(!1),d(""))};return r.jsxs("div",{className:`tag-selector ${l}`,ref:A,children:[t.length>0&&r.jsx("div",{className:"selected-tags mb-2 d-flex flex-wrap gap-1",children:t.map(a=>r.jsx(z,{tag:a,size:"sm",onRemove:()=>J(a),onClick:()=>G(a)},a.id||`new-${a.name}`))}),r.jsxs(Q,{isOpen:m,toggle:()=>u(!m),children:[r.jsx(X,{tag:"div",className:"w-100",children:r.jsxs("div",{className:"position-relative",children:[r.jsx(T,{innerRef:Z,type:"text",placeholder:n,value:o,onChange:a=>d(a.target.value),onFocus:q,onKeyDown:V,className:"pe-4",disabled:s}),r.jsx("div",{className:"position-absolute end-0 top-50 translate-middle-y pe-2",children:s||C?r.jsx(Y,{size:"sm"}):r.jsx(ae,{size:16,className:"text-muted"})})]})}),r.jsxs(ee,{className:"w-100",style:{maxHeight:"300px",overflowY:"auto"},children:[I.map(a=>r.jsx("div",{className:"dropdown-item d-flex align-items-center gap-2",onClick:()=>B(a),style:{cursor:"pointer"},children:r.jsx(z,{tag:a,size:"sm",showIcon:!0})},a.id)),b&&r.jsxs("div",{className:"dropdown-item d-flex align-items-center gap-2 border-top",onClick:O,style:{cursor:"pointer"},children:[r.jsx(re,{size:16,className:"text-primary"}),r.jsxs("span",{className:"text-primary",children:['Create "',o,'"']})]}),I.length===0&&!b&&o&&r.jsx("div",{className:"dropdown-item text-muted",children:"No tags found"}),C&&r.jsxs("div",{className:"dropdown-item text-muted d-flex align-items-center gap-2",children:[r.jsx(Y,{size:"sm"}),"Loading tags..."]})]})]}),c&&r.jsx("div",{className:"modal show d-block",style:{backgroundColor:"rgba(0,0,0,0.5)"},children:r.jsx("div",{className:"modal-dialog modal-md",children:r.jsxs("div",{className:"modal-content",children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h5",{className:"modal-title",children:"Edit Tag"}),r.jsx("button",{type:"button",className:"btn-close",onClick:()=>h(null)})]}),r.jsxs("div",{className:"modal-body",children:[r.jsxs("div",{className:"mb-3",children:[r.jsx("label",{className:"form-label",children:"Name"}),r.jsx(T,{value:c.name,onChange:a=>{const f=ne(a.target.value);h({...c,name:f})},placeholder:"tag-name"})]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("label",{className:"form-label",children:"Color"}),r.jsxs("div",{className:"mb-2",children:[r.jsx("label",{className:"form-label small text-muted",children:"Preset Colors"}),r.jsx("div",{className:"d-flex flex-wrap gap-2",children:w.map(a=>r.jsx("button",{type:"button",className:`btn p-0 border ${c.colour===a?"border-dark border-2":"border-light"}`,style:{width:"30px",height:"30px",backgroundColor:a,borderRadius:"50%"},onClick:()=>h({...c,colour:a})},a))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"form-label small text-muted",children:"Custom Color"}),r.jsxs("div",{className:"d-flex align-items-center gap-2",children:[r.jsx("input",{type:"color",className:"form-control form-control-color",value:c.colour,onChange:a=>h({...c,colour:a.target.value}),style:{width:"50px",height:"38px"}}),r.jsx(T,{type:"text",value:c.colour,onChange:a=>h({...c,colour:a.target.value}),placeholder:"#FF6B6B",style:{fontFamily:"monospace"}})]})]})]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("label",{className:"form-label",children:"Icon"}),r.jsx("div",{className:"d-flex flex-wrap gap-2",style:{maxHeight:"200px",overflowY:"auto"},children:se.map(({name:a,component:f})=>r.jsx("button",{type:"button",className:`btn btn-outline-secondary d-flex align-items-center justify-content-center ${c.icon===a?"active":""}`,style:{width:"40px",height:"40px",padding:"0"},onClick:()=>h({...c,icon:a}),title:a,children:r.jsx(f,{size:20})},a))}),r.jsx("div",{className:"mt-2",children:r.jsxs("small",{className:"text-muted",children:["Selected: ",c.icon||"Tag"]})})]})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx(F,{color:"primary",onClick:K,children:"Save"}),r.jsx(F,{color:"secondary",onClick:()=>h(null),children:"Cancel"})]})]})})})]})};export{Pe as T,Le as a,Re as b,me as c,He as d,N as e,fe as f,We as g,ue as h,_e as i,W as j,L as k,_ as l,ie as m,$ as n,Ee as o,$e as p,y as q,R as r,de as s,g as t,he as u};
//# sourceMappingURL=TagSelector-CI1icoJO.js.map
