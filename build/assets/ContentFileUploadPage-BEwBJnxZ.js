import{k as N,g as B,r,j as e,F as L,A as R,G as A,I as f,B as x,H as E}from"./index-C-RVz6Ax.js";import{C as w,a as D}from"./CardBody-sAodfdc3.js";import{F as j,L as y}from"./Label-jeggPgyg.js";import{u as q}from"./useUploadContentFile-D4-uNPXS.js";const J=()=>{const F=N(),P=B(),U=new URLSearchParams(P.search).get("path")||"",[i,b]=r.useState(null),[u,h]=r.useState(0),[c,S]=r.useState(U),[l,p]=r.useState(!1),[g,d]=r.useState([]),v=q(),C=s=>{s.target.files&&s.target.files.length>0&&b(s.target.files)},$=async s=>{if(s.preventDefault(),!i||i.length===0||l)return;d([]),h(0),p(!0);const t=Array.from(i);for(let n=0;n<t.length;n++){const o=t[n];try{let a=c?`${c}/${o.name}`:o.name;a=a.replace(/^\//,""),console.log(`Uploading file ${n+1}/${t.length}: ${a}`),await v.mutateAsync({path:a,file:o}),d(m=>[...m,{name:o.name,success:!0}])}catch(a){console.error(`Error uploading ${o.name}:`,a),d(m=>[...m,{name:o.name,success:!1,error:a instanceof Error?a.message:"Unknown error"}])}h((n+1)/t.length*100)}p(!1)},k=()=>{F("/sysadmin/contents")};return e.jsxs("div",{children:[e.jsx("h3",{children:"Upload Files"}),l&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{children:"Uploading Files..."}),e.jsxs(L,{value:u,className:"mb-2",children:[Math.round(u),"%"]})]}),g.length>0&&e.jsx(w,{className:"mb-4",children:e.jsxs(D,{children:[e.jsx("h5",{children:"Upload Results"}),g.map((s,t)=>e.jsxs(R,{color:s.success?"success":"danger",children:[s.name,":"," ",s.success?"Uploaded successfully":`Failed - ${s.error}`]},t))]})}),e.jsxs(A,{onSubmit:$,children:[e.jsxs(j,{children:[e.jsx(y,{for:"destinationPath",children:"Destination Path"}),e.jsx(f,{type:"text",id:"destinationPath",value:c,onChange:s=>S(s.target.value),placeholder:"e.g., images/blog"}),e.jsx("small",{className:"form-text text-muted",children:'Leave empty to upload to the root directory, or specify a path like "images/blog"'})]}),e.jsxs(j,{children:[e.jsx(y,{for:"files",children:"Select Files"}),e.jsx(f,{type:"file",id:"files",multiple:!0,onChange:C,disabled:l})]}),e.jsx(x,{color:"primary",type:"submit",className:"me-2",disabled:!i||l,children:l?e.jsx(E,{size:"sm"}):"Upload"}),e.jsx(x,{color:"secondary",onClick:k,children:"Back to Files"})]})]})};export{J as default};
//# sourceMappingURL=ContentFileUploadPage-BEwBJnxZ.js.map
